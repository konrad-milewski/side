import React, { useEffect } from "react";

export const App = () => {
  useEffect(() => {
    // fetch the data.json file and check if the user id is in it
    fetch("data.json")
      .then((response) => response.text()) // get the response as text
      .then((data) => {
        // data is a string, parse it as JSON
        data = JSON.parse(data); // data is now an array of objects
        // get the user id from comsiIdRef.current
        const userId = comsiIdRef.current;
        // find the user object that matches the user id
        const user = data.find((user) => user.id === userId);
        if (user) {
          // user is already in the database, do nothing
          console.log("Welcome back, user " + userId);
        } else {
          // user is not in the database, add them to it
          console.log("Welcome, new user " + userId);
          data.push({ id: userId }); // add the new user object to the array
          // convert the data array back to JSON string and save it to a new file
          const newData = JSON.stringify(data);
          // use FileSaver.js library to save the file locally
          // you may need to install it using npm install file-saver
          const FileSaver = require("file-saver");
          const blob = new Blob([newData], { type: "application/json" });
          FileSaver.saveAs(blob, "data.json");
        }
      });
  }, []); // only run once when the component mounts

  return <div>App</div>;
};
